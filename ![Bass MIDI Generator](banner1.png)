# Bass MIDI Generator (v0.1 → v0.2)

This project is a **Bass MIDI Generator** for EDM/house music. It runs in a Jupyter/Colab notebook and generates bassline MIDI files you can drag directly into your DAW (Ableton, FL Studio, Logic, etc.).

The goals of this project are to:

- Quickly create **usable bassline ideas** for house/EDM tracks.  
- Let you control **key, BPM, number of bars, and basic pattern behavior**.  
- Provide a foundation for future versions with **groove, syncopation, presets, and more advanced generators**.

All generated MIDI files are written to a `bass_midi_output` folder and can be loaded into any DAW.

---

## Versions

### v0.1

- Simple, root-focused basslines.  
- One note per beat using a basic 4/4 timing grid.  
- Good for static, scaffolding-style bass ideas and quick tests.

### v0.2

- Style-based timing grids:
  - `four_on_floor`, `offbeat`, `rolling`, `minimal`.
- Note density control (how busy the line is).
- Optional octave movement (single- or two-octave behavior).
- Pitch variation, groove, and velocity movement for a more “human” feel.
- A **one-click, prompt-based generator** (main user-facing cell).
- Internal clamping so the pattern **always ends exactly at the requested number of bars**.

---

## Notebook Structure

The main notebook is structured into logical sections so you can read it top-to-bottom and see how the generator is built.

### v0.1 Core

- **Cell 1 – Title & Overview**  
  High-level description of the project, goals, and basic workflow.

- **Cell 2 – Imports & Global Setup**  
  Installs `mido` if needed and imports all libraries.  
  Defines global MIDI defaults (`DEFAULT_BPM`, `TICKS_PER_BEAT`, `DEFAULT_VELOCITY`, `DEFAULT_CHANNEL`), sets the project root, and creates the `bass_midi_output` directory.

- **Cell 3 – Core User Configuration (v0.1)**  
  Basic settings for the original generator:
  - `key`, `scale_mode` (minor), `bpm`, `num_bars`, `root_midi_note`  
  - `output_filename_v01` for the v0.1 MIDI file.  

- **Cell 4 – Scale & Note Utilities**  
  Utilities for:
  - Mapping keys to base MIDI notes (`KEY_TO_MIDI_BASE`).  
  - Building a natural minor scale (`get_scale_midi_notes`).  
  - Choosing a good bass root in the chosen scale (`choose_root_note`).  
  - Simple interval helpers (`get_fifth`, `get_octave_up`, `get_octave_down`).

- **Cell 5 – Basic Timing Grid (v0.1)**  
  Builds a 4/4 timing grid:
  - `build_basic_timing_grid(num_bars)` → one note per beat.  
  - `bar_beat_to_absolute_beats(...)` converts (bar, beat_in_bar) into an absolute beat index.

- **Cell 6 – v0.1 Bassline Generator**  
  `generate_bassline_v01(...)`:
  - Uses the basic grid from Cell 5 and scale utilities from Cell 4.  
  - Creates root-focused bass notes with start times and durations expressed in both beats and ticks.

- **Cell 7 – MIDI Writer Utility**  
  `write_bassline_to_midi(note_events, output_filename, bpm, ...)`:
  - Takes note events from v0.1 or v0.2.  
  - Creates a MIDI file with the global `TICKS_PER_BEAT`.  
  - Sets tempo from BPM and writes correct `note_on`/`note_off` events with proper delta times.  
  - Saves the file into `bass_midi_output` and prints an approximate pattern length in beats and bars.

- **Cell 8 – v0.1 Run Cell**  
  Simple end-to-end runner for v0.1:
  - Uses config from Cell 3.  
  - Calls `generate_bassline_v01` and `write_bassline_to_midi`.  
  - Prints a summary (key, BPM, bars, note count, filename).

---

### v0.2 Advanced Generator

- **Cell 9 – Extended Configuration for v0.2**  
  Defines higher-level controls used by the v0.2 ecosystem:
  - `pattern_style`, `note_density`, `octave_mode`, `variation_amount`, `groove_amount`.  
  - `output_filename_v02`.  
  Bundled into `bass_config_v02` and used by presets and advanced generators.

- **Cell 10 – Pattern Style Helpers (v0.2)**  
  Functions to build style-based timing grids:
  - `_per_bar_positions_for_style(style)` defines per-bar beat positions for:
    - `four_on_floor`, `offbeat`, `rolling`, `minimal` (and a fallback).  
  - `build_timing_grid_for_style(style, num_bars, note_density)`:
    - Applies note density to decide which candidate hits survive.  
    - Ensures at least one note per bar even at very low density.

- **Cell 11 – Groove & Humanization Helpers**  
  Functions to add feel:
  - `apply_timing_groove(note_events, groove_amount, ...)`:
    - Swings off-beat 8th notes and adds micro-timing jitter.  
    - Recomputes `start_tick` using `TICKS_PER_BEAT`.  
  - `apply_velocity_variation(note_events, variation_amount, ...)`:
    - Adds velocity randomness and extra accents on the downbeat of each bar.  

- **Cell 12 – v0.2 Bassline Generator (Advanced Logic)**  
  `generate_bassline_v02(...)`:
  - Uses the style timing grid from Cell 10.  
  - Builds scale notes and chooses a good bass root (Cell 4).  
  - Adds pitch variation and optional octave jumps (single- or two-octave behavior).  
  - Applies timing groove and velocity variation (Cell 11).  
  - **Clamps any notes that would extend past the final bar**, so the pattern length always matches `num_bars` exactly.  

- **Cell 13 – Presets & A/B Comparison**  
  - `bass_presets`: dictionary of named presets such as:
    - `classic_house`, `rolling_bass`, `minimal_tech`.  
  Each preset defines key, scale, BPM, bar length, root note, v0.2 pattern/groove settings, and output filenames.  
  - `list_bass_presets()` prints available presets and descriptions.  
  - `generate_v01_and_v02_for_preset(preset_name)`:
    - Generates both v0.1 **and** v0.2 files for the chosen preset.  
    - Saves them to `bass_midi_output`.  
    - Prints a summary with filenames and note counts for quick A/B in your DAW.

- **Cell 14 – One-Click v0.2 Bass MIDI Generator (Prompt + Download)**  
  Main **user-facing** generator for v0.2:
  - Prompts in the console for:
    - `Key`  
    - `Scale type (major/minor)`  
    - `Number of bars`  
    - `Tempo (BPM)`  
    - `Pattern style` (`four_on_floor`, `offbeat`, `rolling`, `minimal`)  
  - Uses sensible internal defaults for:
    - `root_midi_note_v02`, `note_density_v02`, `octave_mode_v02`, `variation_amount_v02`, `groove_amount_v02`.  
  - Calls `generate_bassline_v02` to build note events, then `write_bassline_to_midi` to save them.  
  - Builds a descriptive output filename that includes key, scale, BPM, bar count, and a timestamp, e.g.:  
    `bass_pattern_v0_2_Aminor_126bpm_8bars_YYYYMMDD_HHMMSS.mid`.  
  - Prints a detailed summary (key, scale, BPM, bars, pattern style, density, octave mode, variation/groove amounts, note count, and file path).  
  - Shows the **actual pattern length in beats and bars** for debugging.  
  - If running in Google Colab, automatically triggers a file download.  
    Otherwise, the file is written to `bass_midi_output` for manual use.

---

## Typical Workflow

1. **First-time setup**  
   - Run the notebook **top-to-bottom once**.  
   - This ensures all utilities, generators, and presets are defined.

2. **Fast custom basslines (recommended)**  
   - Run the **one-click v0.2 generator cell**.  
   - Answer the prompts for key, scale, number of bars, BPM, and pattern style.  
   - Drag the generated `.mid` file from `bass_midi_output` into your DAW.

3. **Preset-based A/B comparisons**  
   - Call `list_bass_presets()` to see available presets.  
   - Run `generate_v01_and_v02_for_preset("classic_house")` (or another preset name).  
   - Compare simple (v0.1) vs advanced (v0.2) versions of the same idea in your DAW.

4. **Basic v0.1 patterns**  
   - Adjust settings in the v0.1 config cell and run the v0.1 run cell if you want a very simple, on-the-grid bassline for scaffolding or layering.

---

## Output

All generated MIDI files are written to:

```text
bass_midi_output/
